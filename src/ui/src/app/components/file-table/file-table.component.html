<div class="flex justify-between h-10">
    <fg-folder-breadcrumb [topMenu]="topMenu"></fg-folder-breadcrumb>

    <div class="flex items-center">
        <p-button [hidden]="!isShareAccessVisible" [disabled]="!selectedItem" (onClick)="share.toggle($event)" size="small" severity="info" class=""
            styleClass="py-1" class="mr-2" label="Поділитись" icon="pi pi-share-alt" />
        <p-overlayPanel #share>
            <div class="flex flex-col gap-3 w-80">
                <div class="w-full">
                    <h6 class="text-sm mb-2">Введіть email людини з якою ви хочете поділитись</h6>
                    <p-multiSelect styleClass="w-full p-0 mb-2" [options]="(users$ | async) || []"
                        [(ngModel)]="selectedUsers" [filter]="true" optionLabel="name"
                        placeholder="Виберіть користувача" />

                    <p-button label="Поділитись" [disabled]="selectedUsers.length === 0"
                        [badge]="selectedUsers.length > 0 ? selectedUsers.length.toString() : undefined"
                        (onClick)="shareItem()" [size]="'small'" styleClass="w-full" />
                </div>
            </div>
        </p-overlayPanel>

        <p-button size="small" (onClick)="download()" [disabled]="!selectedItem || selectedItem.type === 'folder'" severity="contrast" styleClass="py-1"
            label="Завантажити" icon="pi pi-download" class="mr-2" />
        <p-button (onClick)="deleteItems()" [hidden]="!isDeleteVisible" [loading]="" [disabled]="!selectedItem" size="small" severity="danger"
            styleClass="py-1" label="Видалити" icon="pi pi-trash" />
    </div>
</div>

<!-- 7.5rem = 2.5rem table header + 5rem header  -->
<div class="h-[calc(100vh-7.5rem)] overflow-y-auto">
    <p-table #dt [value]="tableData" selectionMode="single" [(selection)]="selectedItem" [paginator]="true" [rows]="18">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 4rem"></th>
                <th>Назва</th>
                <th>Дата створення</th>
                <th>Розмір</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-file>
            <tr>
                <td>
                    <p-tableRadioButton [value]="file" />
                </td>
                <td>
                    <a *ngIf="file.type === 'folder'" (click)="navigateToFolder(file)"
                        class="cursor-pointer hover:text-blue-500">
                        <i [class]="getFileIcon(file)" class="mr-2"></i>
                        {{file.name}}
                    </a>
                    <span *ngIf="file.type === 'file'">
                        <i [class]="getFileIcon(file)" class="mr-2"></i>
                        {{file.name}}
                    </span>


                </td>
                <td>{{convertToLocalDateTime(file.createdAt)}}</td>
                <td>{{file.size}}</td>
            </tr>
        </ng-template>
    </p-table>
</div>
